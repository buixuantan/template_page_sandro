define(['jquery'],function($){'use strict';$.widget('mage.imageSlider',{options:{mediaCallback:'',imageCache:[]},_create:function(){var self=this;$("body").on('click','.prev-product-item, .next-product-item',function(e){var target=$(e.target);var photo=target.parent('.product-item-photo');let productId=parseInt(photo.attr('data-product-id'));let productImage=photo.find('a .product-image-photo');if(!(productId in self.options.imageCache)){let mediaCallData={'product_id':productId,'isAjax':true};$.ajax({url:self.options.mediaCallback,cache:true,type:'GET',dataType:'json',showLoader:false,data:mediaCallData,}).success(function(response){if(response.gallery){let i=0;self.options.imageCache[productId]=[];$.each(response.gallery,function(){self.options.imageCache[productId].push(this.medium);if(!photo.attr('data-current-image').length&&this.isMain==true){photo.attr('data-current-image',i);}
i++;})
if(target.hasClass('prev-product-item')){let currentImage=parseInt(photo.attr('data-current-image'));let preImage=((currentImage-1)>0)?(currentImage-1):(self.options.imageCache[productId].length-1);productImage.attr('src',self.options.imageCache[productId][preImage]);photo.attr('data-current-image',preImage);}else{let currentImage=parseInt(photo.attr('data-current-image'));let nextImage=((currentImage+1)<self.options.imageCache[productId].length)?(currentImage+1):0;productImage.attr('src',self.options.imageCache[productId][nextImage]);photo.attr('data-current-image',nextImage);}}});}else{if(target.hasClass('prev-product-item')){let currentImage=parseInt(photo.attr('data-current-image'));let preImage=((currentImage-1)>0)?(currentImage-1):(self.options.imageCache[productId].length-1);productImage.attr('src',self.options.imageCache[productId][preImage]);photo.attr('data-current-image',preImage);}
if(target.hasClass('next-product-item')){let currentImage=parseInt(photo.attr('data-current-image'));let nextImage=((currentImage+1)<self.options.imageCache[productId].length)?(currentImage+1):0;productImage.attr('src',self.options.imageCache[productId][nextImage]);photo.attr('data-current-image',nextImage);}}
e.stopPropagation();})}});return $.mage.imageSlider;});